<div class="row mt-3 mb-5">
    <div class="col-sm-12 mt-3">
        <h2>Comments</h2>
    </div>
    <div class="col-sm-12 col-lg-8 offset-lg-2">
        <form name="BlogComments" action="/comment-thanks" method="POST" netlify-honeypot="bot-field" netlify>
            <input name="path" type="hidden" value="{{ .RelPermalink }}">
            <input name="bot-field" type="hidden">
            <div class="form-group">
                <label for="inputName"><h4 class="mb-0">Name</h4></label>
                <input name="Name" type="name" class="form-control" id="inputName" placeholder="John Doe" required>
            </div>
            <div class="form-group">
                <label for="inputEmail"><h4 class="mb-0">Email address</h4></label>
                <input name="Email" type="email" class="form-control" id="inputEmail" placeholder="john.doe@example.com" required>
                <span class="small">Confidential, will not be shared with anyone or published here.</span>
            </div>
            <div class="form-group">
                <label for="inputComment"><h4 class="mb-0">Comment</h4></label>
                <textarea name="Comment" class="form-control" id="inputComment" placeholder="Your comment..." style="height: 150px; resize: none;" required></textarea>
            </div>
            <button type="submit" class="btn btn-primary px-3"><i class="fas fa-comment"></i>&nbsp;&nbsp;Submit Comment</button>
        </form>
    </div>
</div>

{{ $thisPost := .RelPermalink }}
{{ $comments := .Site.Data.comments }}
{{ $.Scratch.Set "counter" 0 }}
{{ range $comments }}
    {{ range . }}{{ if eq .path $thisPost }}{{ $.Scratch.Set "counter" (add ($.Scratch.Get "counter") 1) }}{{ end }}{{ end }}
{{ end }}
{{ if gt ($.Scratch.Get "counter") 0 }}{{/*  only show comment section if there are comments  */}}
    <div class="row mb-5">
    {{ range $comments }}
        {{ range . }}
            {{ if eq .path $thisPost }}
            <div class="col-sm-12 py-3">
                <div class="shadow-sm px-4 py-4">
                    <i><span class="small">{{ .name }}</span><span class="small"> on {{ .date | dateFormat "Mon, 02 Jan. 2006, 15:04 MST" }}</span></i>
                    <p class="px-3 mt-3 mb-0">{{ .comment }}</p>
                </div>
            </div>
            {{ end }}
        {{ end }}
    {{ end }}
    </div>
{{ end }}

<style>
    .form-control {
        display: block;
        width: 100%;
        padding: 0.375rem 0.75rem;
        font-size: 1rem;
        line-height: 1.5;
        color: #2b4450;
        background-color: #fff;
        background-clip: padding-box;
        border: 1px solid #dfebed;
        border-radius: 0.1rem;
        transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }

    @media screen and (prefers-reduced-motion: reduce) {
        .form-control {
            transition: none;
        }
    }

    .form-control:focus {
        color: #2b4450;
        background-color: #fff;
        border-color: #497285;
        outline: 0;
        box-shadow: 0 0 0 0.2rem rgba(43, 68, 80, 0.25);
    }

    .form-control::placeholder {
        color: #6c757d;
        opacity: 1;
    }

    .form-group {
        margin-bottom: 1rem;
    }
</style>